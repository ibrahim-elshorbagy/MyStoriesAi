import{r as u,a as I,j as e,H as V,L as C}from"./app-B9-13Wrp.js";import{A as L}from"./AppLayout-Ngc6PsSM.js";import{u as M}from"./useTrans-BkTq1qdy.js";import{I as m}from"./InputLabel-Cuo48Ixa.js";import{T as h}from"./TextInput-B29x2xLE.js";import{S as j}from"./SelectInput-Br9HuNFB.js";import{I as o}from"./InputError--0KWuisN.js";import{P as H}from"./PrimaryButton-BWCRKmBA.js";import{S as O}from"./SecondaryButton-BQkczJhi.js";import{D as g}from"./DragFileInput-2rIJNUUa.js";import{T as b}from"./TextArea-Clg8B4Ot.js";import"./ApplicationLogo-2FXmSzsu.js";import"./Toastify-CztXOj5Z.js";import"./CookieModal-BdON5OCE.js";import"./AppModal-Bz2NfCUZ.js";function le({story:l,categories:F=[]}){const{t}=M(),[x,T]=u.useState(l.gallery_images_ar||[]),[p,E]=u.useState(l.gallery_images_en||[]),[f,q]=u.useState(l.gallery_images_de||[]),{data:r,setData:n,post:$,errors:i,processing:y}=I({title_ar:l.title?.ar||"",title_en:l.title?.en||"",title_de:l.title?.de||"",excerpt_ar:l.excerpt?.ar||"",excerpt_en:l.excerpt?.en||"",excerpt_de:l.excerpt?.de||"",content_ar:l.content?.ar||"",content_en:l.content?.en||"",content_de:l.content?.de||"",category_id:l.category_id||"",gender:l.gender?.toString()||"",status:l.status||"draft",cover_image_ar:null,cover_image_en:null,cover_image_de:null,gallery_images_ar:[],gallery_images_en:[],gallery_images_de:[],existing_gallery_images_ar:l.gallery_images_ar||[],existing_gallery_images_en:l.gallery_images_en||[],existing_gallery_images_de:l.gallery_images_de||[],pdf_ar:null,pdf_en:null,pdf_de:null}),N=u.useRef(null),k=u.useRef(null),w=u.useRef(null);u.useEffect(()=>{const a=document.createElement("script");return a.src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.3/tinymce.min.js",a.async=!0,a.onload=()=>G(),document.body.appendChild(a),()=>{window.tinymce&&window.tinymce.remove()}},[]);const G=()=>{if(!window.tinymce)return;const a={height:600,menubar:!0,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","help","wordcount","directionality"],toolbar:"undo redo | blocks | bold italic forecolor | alignleft aligncenter alignright alignjustify | ltr rtl | bullist numlist outdent indent | image media table | removeformat | help",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }",automatic_uploads:!1,images_dataimg_filter:function(s){return s.hasAttribute("internal-blob")},images_upload_handler:function(s,c,_){const d=new FileReader;d.onload=function(){c(d.result)},d.onerror=function(){_("Failed to convert image to base64")},d.readAsDataURL(s.blob())},paste_data_images:!0};window.tinymce.init({...a,selector:"#content_ar",directionality:"rtl",setup:s=>{N.current=s,s.on("init",()=>{s.setContent(r.content_ar)}),s.on("change",()=>{n("content_ar",s.getContent())})}}),window.tinymce.init({...a,selector:"#content_en",directionality:"ltr",setup:s=>{k.current=s,s.on("init",()=>{s.setContent(r.content_en)}),s.on("change",()=>{n("content_en",s.getContent())})}}),window.tinymce.init({...a,selector:"#content_de",directionality:"ltr",setup:s=>{w.current=s,s.on("init",()=>{s.setContent(r.content_de)}),s.on("change",()=>{n("content_de",s.getContent())})}})},v=(a,s)=>{if(s==="ar"){const c=x.filter(_=>_!==a);T(c),n("existing_gallery_images_ar",c)}else if(s==="en"){const c=p.filter(_=>_!==a);E(c),n("existing_gallery_images_en",c)}else if(s==="de"){const c=f.filter(_=>_!==a);q(c),n("existing_gallery_images_de",c)}},S=a=>{a.preventDefault();const s=N.current?.getContent()||r.content_ar||"",c=k.current?.getContent()||r.content_en||"",_=w.current?.getContent()||r.content_de||"",d={title_ar:r.title_ar,title_en:r.title_en,title_de:r.title_de,excerpt_ar:r.excerpt_ar,excerpt_en:r.excerpt_en,excerpt_de:r.excerpt_de,content_ar:s,content_en:c,content_de:_,category_id:r.category_id,gender:r.gender,status:r.status,existing_gallery_images_ar:x,existing_gallery_images_en:p,existing_gallery_images_de:f,_method:"PUT"};r.cover_image_ar&&(d.cover_image_ar=r.cover_image_ar),r.cover_image_en&&(d.cover_image_en=r.cover_image_en),r.cover_image_de&&(d.cover_image_de=r.cover_image_de),r.gallery_images_ar?.length>0&&(d.gallery_images_ar=r.gallery_images_ar),r.gallery_images_en?.length>0&&(d.gallery_images_en=r.gallery_images_en),r.gallery_images_de?.length>0&&(d.gallery_images_de=r.gallery_images_de),r.pdf_ar&&(d.pdf_ar=r.pdf_ar),r.pdf_en&&(d.pdf_en=r.pdf_en),r.pdf_de&&(d.pdf_de=r.pdf_de),$(route("admin.stories.update",l.id),{data:d,preserveScroll:!0})},A=F.map(a=>({value:a.id,label:a.name_value})),D=[{value:"",label:t("select_gender")},{value:"0",label:t("boy")},{value:"1",label:t("girl")}],R=[{value:"draft",label:t("draft")},{value:"published",label:t("published")},{value:"archived",label:t("archived")}];return e.jsxs(L,{children:[e.jsx(V,{title:`${t("edit_story")} - ${l.title_value}`}),e.jsx("div",{className:"m-3 xl:m-5",children:e.jsx("div",{className:"overflow-hidden rounded-2xl shadow-lg dark:bg-neutral-900 border border-neutral-300 dark:border-neutral-700",children:e.jsxs("div",{className:"p-6 text-neutral-900 dark:text-neutral-100",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(C,{href:route("admin.stories.index"),className:"flex items-center text-neutral-600 hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-neutral-100 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-arrow-left rtl:rotate-180 mx-2"}),t("stories")]}),e.jsx("span",{className:"text-neutral-400 dark:text-neutral-600",children:"/"}),e.jsxs("h1",{className:"text-2xl font-bold leading-tight text-neutral-900 dark:text-neutral-100",children:[e.jsx("i",{className:"fa-solid fa-edit text-green-500 mx-2"}),t("edit_story")," - ",l.title_value]})]})}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"title_ar",value:t("story_title_ar"),required:!0}),e.jsx(h,{id:"title_ar",type:"text",name:"title_ar",value:r.title_ar,className:"mt-1 block w-full",onChange:a=>n("title_ar",a.target.value),required:!0}),e.jsx(o,{message:i.title_ar,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"title_en",value:t("story_title_en"),required:!0}),e.jsx(h,{id:"title_en",type:"text",name:"title_en",value:r.title_en,className:"mt-1 block w-full",onChange:a=>n("title_en",a.target.value),required:!0}),e.jsx(o,{message:i.title_en,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"title_de",value:t("story_title_de"),required:!0}),e.jsx(h,{id:"title_de",type:"text",name:"title_de",value:r.title_de,className:"mt-1 block w-full",onChange:a=>n("title_de",a.target.value),required:!0}),e.jsx(o,{message:i.title_de,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"excerpt_ar",value:t("story_excerpt_ar"),required:!0}),e.jsx(b,{name:"excerpt_ar",label:t("story_excerpt_ar"),value:r.excerpt_ar,onChange:a=>n("excerpt_ar",a.target.value),rows:3}),e.jsx(o,{message:i.excerpt_ar,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"excerpt_en",value:t("story_excerpt_en"),required:!0}),e.jsx(b,{name:"excerpt_en",label:t("story_excerpt_en"),value:r.excerpt_en,onChange:a=>n("excerpt_en",a.target.value),rows:3}),e.jsx(o,{message:i.excerpt_en,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"excerpt_de",value:t("story_excerpt_de"),required:!0}),e.jsx(b,{name:"excerpt_de",label:t("story_excerpt_de"),value:r.excerpt_de,onChange:a=>n("excerpt_de",a.target.value),rows:3}),e.jsx(o,{message:i.excerpt_de,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(j,{name:"category_id",label:t("category"),value:r.category_id,onChange:a=>n("category_id",a.target.value),options:[{value:"",label:t("select_category")},...A],icon:"fa-layer-group",required:!0}),e.jsx(o,{message:i.category_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(j,{name:"gender",label:t("gender"),value:r.gender,onChange:a=>n("gender",a.target.value),options:D,icon:"fa-venus-mars"}),e.jsx(o,{message:i.gender,className:"mt-2"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx(j,{name:"status",label:t("status"),value:r.status,onChange:a=>n("status",a.target.value),options:R,icon:"fa-circle-check",required:!0}),e.jsx(o,{message:i.status,className:"mt-2"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"content_ar",value:t("story_content_ar"),required:!0}),e.jsx("div",{className:"no-tailwindcss-support-display",children:e.jsx("textarea",{id:"content_ar",name:"content_ar",className:"mt-1 block w-full"})}),e.jsx(o,{message:i.content_ar,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"content_en",value:t("story_content_en"),required:!0}),e.jsx("div",{className:"no-tailwindcss-support-display",children:e.jsx("textarea",{id:"content_en",name:"content_en",className:"mt-1 block w-full"})}),e.jsx(o,{message:i.content_en,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"content_de",value:t("story_content_de"),required:!0}),e.jsx("div",{className:"no-tailwindcss-support-display",children:e.jsx("textarea",{id:"content_de",name:"content_de",className:"mt-1 block w-full"})}),e.jsx(o,{message:i.content_de,className:"mt-2"})]})]}),e.jsxs("div",{className:"space-y-6 p-6 bg-neutral-50 dark:bg-neutral-800/50 rounded-lg border border-neutral-200 dark:border-neutral-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-100 border-b border-neutral-200 dark:border-neutral-700 pb-2",children:[e.jsx("i",{className:"fa-solid fa-file-arrow-up text-blue-500 me-2"}),t("files")]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(g,{id:"cover_image_ar",label:t("cover_image_ar"),accept:"image/*",onChange:a=>n("cover_image_ar",a),error:i.cover_image_ar,value:r.cover_image_ar,keyValue:l.cover_image_ar?{name:t("current_cover_image"),path:l.cover_image_ar}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.cover_image_ar&&e.jsx("div",{className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400",children:e.jsx("img",{src:`/storage/${l.cover_image_ar}`,alt:t("current_cover_image"),className:"w-20 h-20 object-cover rounded-md border border-neutral-300 dark:border-neutral-600"})})})})}),e.jsx("div",{children:e.jsx(g,{id:"cover_image_en",label:t("cover_image_en"),accept:"image/*",onChange:a=>n("cover_image_en",a),error:i.cover_image_en,value:r.cover_image_en,keyValue:l.cover_image_en?{name:t("current_cover_image"),path:l.cover_image_en}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.cover_image_en&&e.jsx("div",{className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400",children:e.jsx("img",{src:`/storage/${l.cover_image_en}`,alt:t("current_cover_image"),className:"w-20 h-20 object-cover rounded-md border border-neutral-300 dark:border-neutral-600"})})})})}),e.jsx("div",{children:e.jsx(g,{id:"cover_image_de",label:t("cover_image_de"),accept:"image/*",onChange:a=>n("cover_image_de",a),error:i.cover_image_de,value:r.cover_image_de,keyValue:l.cover_image_de?{name:t("current_cover_image"),path:l.cover_image_de}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.cover_image_de&&e.jsx("div",{className:"flex items-center space-x-2 text-sm text-blue-600 dark:text-blue-400",children:e.jsx("img",{src:`/storage/${l.cover_image_de}`,alt:t("current_cover_image"),className:"w-20 h-20 object-cover rounded-md border border-neutral-300 dark:border-neutral-600"})})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(g,{id:"gallery_images_ar",label:t("gallery_images_ar"),accept:"image/*",multiple:!0,showMaxFiles:!1,onChange:a=>n("gallery_images_ar",a),error:i.gallery_images_ar,value:r.gallery_images_ar,helperText:e.jsx("div",{className:"space-y-2",children:x&&x.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-images me-1"}),t("current_gallery_images")," (",x.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map((a,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/storage/${a}`,alt:`Gallery ${s+1}`,className:"object-cover rounded-md border border-neutral-300 dark:border-neutral-600"}),e.jsx("button",{type:"button",onClick:()=>v(a,"ar"),className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:t("delete"),children:e.jsx("i",{className:"fa-solid fa-times text-xs"})})]},s))})]})})})}),e.jsx("div",{children:e.jsx(g,{id:"gallery_images_en",label:t("gallery_images_en"),accept:"image/*",multiple:!0,showMaxFiles:!1,onChange:a=>n("gallery_images_en",a),error:i.gallery_images_en,value:r.gallery_images_en,helperText:e.jsx("div",{className:"space-y-2",children:p&&p.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-images me-1"}),t("current_gallery_images")," (",p.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:p.map((a,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/storage/${a}`,alt:`Gallery ${s+1}`,className:" object-cover rounded-md border border-neutral-300 dark:border-neutral-600"}),e.jsx("button",{type:"button",onClick:()=>v(a,"en"),className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:t("delete"),children:e.jsx("i",{className:"fa-solid fa-times text-xs"})})]},s))})]})})})}),e.jsx("div",{children:e.jsx(g,{id:"gallery_images_de",label:t("gallery_images_de"),accept:"image/*",multiple:!0,showMaxFiles:!1,onChange:a=>n("gallery_images_de",a),error:i.gallery_images_de,value:r.gallery_images_de,helperText:e.jsx("div",{className:"space-y-2",children:f&&f.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-images me-1"}),t("current_gallery_images")," (",f.length,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:f.map((a,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/storage/${a}`,alt:`Gallery ${s+1}`,className:" object-cover rounded-md border border-neutral-300 dark:border-neutral-600"}),e.jsx("button",{type:"button",onClick:()=>v(a,"de"),className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",title:t("delete"),children:e.jsx("i",{className:"fa-solid fa-times text-xs"})})]},s))})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(g,{id:"pdf_ar",label:t("pdf_ar"),accept:".pdf",onChange:a=>n("pdf_ar",a),error:i.pdf_ar,value:r.pdf_ar,keyValue:l.pdf_ar?{name:t("current_pdf"),path:l.pdf_ar}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.pdf_ar&&e.jsxs("div",{className:"flex items-center gap-2 space-x-2 text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-file-pdf"}),e.jsx("span",{children:t("current_pdf")}),e.jsx("a",{href:`/storage/${l.pdf_ar}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:t("view_pdf")})]})})})}),e.jsx("div",{children:e.jsx(g,{id:"pdf_en",label:t("pdf_en"),accept:".pdf",onChange:a=>n("pdf_en",a),error:i.pdf_en,value:r.pdf_en,keyValue:l.pdf_en?{name:t("current_pdf"),path:l.pdf_en}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.pdf_en&&e.jsxs("div",{className:"flex items-center gap-2 space-x-2 text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-file-pdf"}),e.jsx("span",{children:t("current_pdf")}),e.jsx("a",{href:`/storage/${l.pdf_en}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:t("view_pdf")})]})})})}),e.jsx("div",{children:e.jsx(g,{id:"pdf_de",label:t("pdf_de"),accept:".pdf",onChange:a=>n("pdf_de",a),error:i.pdf_de,value:r.pdf_de,keyValue:l.pdf_de?{name:t("current_pdf"),path:l.pdf_de}:null,helperText:e.jsx("div",{className:"space-y-1",children:l.pdf_de&&e.jsxs("div",{className:"flex items-center gap-2 space-x-2 text-sm text-blue-600 dark:text-blue-400",children:[e.jsx("i",{className:"fa-solid fa-file-pdf"}),e.jsx("span",{children:t("current_pdf")}),e.jsx("a",{href:`/storage/${l.pdf_de}`,target:"_blank",rel:"noopener noreferrer",className:"underline hover:no-underline",children:t("view_pdf")})]})})})})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t border-neutral-200 dark:border-neutral-700",children:[e.jsx(O,{icon:"fa-times",as:C,href:route("admin.stories.index"),children:t("cancel")}),e.jsx(H,{icon:"fa-save",type:"submit",disabled:y,children:t(y?"updating":"save_changes")})]})]})]})})})]})}export{le as default};
