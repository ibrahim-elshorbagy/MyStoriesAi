import{_ as ke,r as te,j as d}from"./app-0KCvLrK3.js";import{I as Ee}from"./InputError-C1aYkHJG.js";var Ze=Object.defineProperty,Ie=e=>{throw TypeError(e)},Ke=(e,s,t)=>s in e?Ze(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,h=(e,s,t)=>Ke(e,typeof s!="symbol"?s+"":s,t),De=(e,s,t)=>s.has(e)||Ie("Cannot "+t),se=(e,s,t)=>(De(e,s,"read from private field"),s.get(e)),Qe=(e,s,t)=>s.has(e)?Ie("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(e):s.set(e,t),Xe=(e,s,t,n)=>(De(e,s,"write to private field"),s.set(e,t),t);const Ye="host",qe="queue/data",et="queue/join",$e="upload",tt="login",oe="config",st="info",nt="runtime",at="sleeptime",rt="heartbeat",it="component_server",ot="reset",lt="cancel",ct="app_id",ze="This application is currently busy. Please try again. ",ae="Connection errored out. ",H="Could not resolve app config. ",dt="Could not get space status. ",ut="Could not get API info. ",_e="Space metadata could not be loaded. ",pt="Invalid URL. A full URL path is required.",ht="Not authorized to access this space. ",Re="Invalid credentials. Could not login. ",ft="Login credentials are required to access this space.",gt="File system access is only available in Node.js environments",Ue="Root URL not found in client config",mt="Error uploading file";async function Ne(e,s,t){try{return(await(await fetch(`https://huggingface.co/api/spaces/${e}/jwt`,{headers:{Authorization:`Bearer ${s}`,...t?{Cookie:t}:{}}})).json()).token||!1}catch{return!1}}function _t(e){let s={};return e.forEach(({api_name:t,id:n})=>{t&&(s[t]=n)}),s}async function wt(e){const s=this.options.token?{Authorization:`Bearer ${this.options.token}`}:{};if(s["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"){if(window.gradio_config.current_page&&(e=e.substring(0,e.lastIndexOf("/"))),window.gradio_config.dev_mode){let t=fe(e,this.deep_link?oe+"?deep_link="+this.deep_link:oe);const n=await this.fetch(t,{headers:s,credentials:"include"}),a=await Se(n,e,!!this.options.auth);window.gradio_config={...a,current_page:window.gradio_config.current_page}}return window.gradio_config.root=e,{...window.gradio_config}}else if(e){let t=fe(e,this.deep_link?oe+"?deep_link="+this.deep_link:oe);const n=await this.fetch(t,{headers:s,credentials:"include"});return Se(n,e,!!this.options.auth)}throw new Error(H)}async function Se(e,s,t){var n,a;if(e?.status===401&&!t){const i=await e.json(),r=(n=i?.detail)==null?void 0:n.auth_message;throw new Error(r||ft)}else if(e?.status===401&&t)throw new Error(Re);if(e?.status===200){let i=await e.json();return i.root=s,(a=i.dependencies)==null||a.forEach((r,o)=>{r.id===void 0&&(r.id=o)}),i}else if(e?.status===401)throw new Error(ht);throw new Error(H)}async function yt(){const{http_protocol:e,host:s}=await ye(this.app_reference,this.options.token);try{if(this.options.auth){const t=await Le(e,s,this.options.auth,this.fetch,this.options.token);t&&this.set_cookies(t)}}catch(t){throw Error(t.message)}}async function Le(e,s,t,n,a){const i=new FormData;i.append("username",t?.[0]),i.append("password",t?.[1]);let r={};a&&(r.Authorization=`Bearer ${a}`);const o=await n(`${e}//${s}/${tt}`,{headers:r,method:"POST",body:i,credentials:"include"});if(o.status===200)return o.headers.get("set-cookie");throw o.status===401?new Error(Re):new Error(_e)}function he(e){if(e.startsWith("http")){const{protocol:s,host:t,pathname:n}=new URL(e);return{ws_protocol:s==="https:"?"wss":"ws",http_protocol:s,host:t+(n!=="/"?n:"")}}return{ws_protocol:"wss",http_protocol:"https:",host:new URL(e).host}}const Be=e=>{let s=[];return e.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach(t=>{const[n,a]=t.split(";")[0].split("=");n&&a&&s.push(`${n.trim()}=${a.trim()}`)}),s},we=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,vt=/.*hf\.space\/{0,1}.*$/;async function ye(e,s){const t={};s&&(t.Authorization=`Bearer ${s}`);const n=e.trim().replace(/\/$/,"");if(we.test(n))try{const a=(await(await fetch(`https://huggingface.co/api/spaces/${n}/${Ye}`,{headers:t})).json()).host;return{space_id:e,...he(a)}}catch{throw new Error(_e)}if(vt.test(n)){const{ws_protocol:a,http_protocol:i,host:r}=he(n);return{space_id:r.split("/")[0].replace(".hf.space",""),ws_protocol:a,http_protocol:i,host:r}}return{space_id:!1,...he(n)}}const fe=(...e)=>{try{return e.reduce((s,t)=>(s=s.replace(/\/+$/,""),t=t.replace(/^\/+/,""),new URL(t,s+"/").toString()))}catch{throw new Error(pt)}};function bt(e,s,t){const n={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(e).forEach(a=>{(a==="named_endpoints"||a==="unnamed_endpoints")&&(n[a]={},Object.entries(e[a]).forEach(([i,{parameters:r,returns:o}])=>{var u,c,m,p;const g=((u=s.dependencies.find(l=>l.api_name===i||l.api_name===i.replace("/","")))==null?void 0:u.id)||t[i.replace("/","")]||-1,b=g!==-1?(c=s.dependencies.find(l=>l.id==g))==null?void 0:c.types:{generator:!1,cancel:!1};if(g!==-1&&((p=(m=s.dependencies.find(l=>l.id==g))==null?void 0:m.inputs)==null?void 0:p.length)!==r.length){const l=s.dependencies.find(_=>_.id==g).inputs.map(_=>{var j;return(j=s.components.find(v=>v.id===_))==null?void 0:j.type});try{l.forEach((_,j)=>{if(_==="state"){const v={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};r.splice(j,0,v)}})}catch(_){console.error(_)}}const L=(l,_,j,v)=>({...l,description:jt(l?.type,j),type:xt(l?.type,_,j,v)||""});n[a][i]={parameters:r.map(l=>L(l,l?.component,l?.serializer,"parameter")),returns:o.map(l=>L(l,l?.component,l?.serializer,"return")),type:b}}))}),n}function xt(e,s,t,n){if(s==="Api")return e.type;switch(e?.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(t==="JSONSerializable"||t==="StringSerializable")return"any";if(t==="ListStringSerializable")return"string[]";if(s==="Image")return n==="parameter"?"Blob | File | Buffer":"string";if(t==="FileSerializable")return e?.type==="array"?n==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":n==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(t==="GallerySerializable")return n==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function jt(e,s){return s==="GallerySerializable"?"array of [file, label] tuples":s==="ListStringSerializable"?"array of strings":s==="FileSerializable"?"array of files or single file":e?.description}function Pe(e,s){switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:ze,stage:"error",code:e.code,success:e.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:e.message,session_not_found:e.session_not_found,stage:"error",success:!1}};case"broken_connection":return{type:"broken_connection",status:{queue:!0,message:e.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:s||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"log":return{type:"log",data:e};case"process_generating":return{type:"generating",status:{queue:!0,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration,changed_state_ids:e.success?e.output.changed_state_ids:void 0},data:e.success?e.output:null};case"process_streaming":return{type:"streaming",status:{queue:!0,message:e.output.error,stage:"streaming",time_limit:e.time_limit,code:e.code,progress_data:e.progress_data,eta:e.eta},data:e.output};case"process_completed":return"error"in e.output?{type:"update",status:{queue:!0,title:e.output.title,message:e.output.error,visible:e.output.visible,duration:e.output.duration,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:!0,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data,changed_state_ids:e.success?e.output.changed_state_ids:void 0},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success,eta:e.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:!0}}}const kt=(e=[],s)=>{const t=s?s.parameters:[];if(Array.isArray(e))return s&&t.length>0&&e.length>t.length&&console.warn("Too many arguments provided for the endpoint."),e;const n=[],a=Object.keys(e);return t.forEach((i,r)=>{if(e.hasOwnProperty(i.parameter_name))n[r]=e[i.parameter_name];else if(i.parameter_has_default)n[r]=i.parameter_default;else throw new Error(`No value provided for required parameter: ${i.parameter_name}`)}),a.forEach(i=>{if(!t.some(r=>r.parameter_name===i))throw new Error(`Parameter \`${i}\` is not a valid keyword argument. Please refer to the API for usage.`)}),n.forEach((i,r)=>{if(i===void 0&&!t[r].parameter_has_default)throw new Error(`No value provided for required parameter: ${t[r].parameter_name}`)}),n};async function Et(){if(this.api_info)return this.api_info;const{token:e}=this.options,{config:s}=this,t={"Content-Type":"application/json"};if(e&&(t.Authorization=`Bearer ${e}`),!!s)try{let n,a;if(typeof window<"u"&&window.gradio_api_info)a=window.gradio_api_info;else{const i=fe(s.root,this.api_prefix,st);if(n=await this.fetch(i,{headers:t,credentials:"include"}),!n.ok)throw new Error(ae);a=await n.json()}return"api"in a&&(a=a.api),a.named_endpoints["/predict"]&&!a.unnamed_endpoints[0]&&(a.unnamed_endpoints[0]=a.named_endpoints["/predict"]),bt(a,s,this.api_map)}catch(n){throw new Error("Could not get API info. "+n.message)}}async function $t(e,s,t){var n;const a={};(n=this==null?void 0:this.options)!=null&&n.token&&(a.Authorization=`Bearer ${this.options.token}`);const i=1e3,r=[];let o;for(let u=0;u<s.length;u+=i){const c=s.slice(u,u+i),m=new FormData;c.forEach(g=>{m.append("files",g)});try{const g=t?`${e}${this.api_prefix}/${$e}?upload_id=${t}`:`${e}${this.api_prefix}/${$e}`;o=await this.fetch(g,{method:"POST",body:m,headers:a,credentials:"include"})}catch(g){throw new Error(ae+g.message)}if(!o.ok){const g=await o.text();return{error:`HTTP ${o.status}: ${g}`}}const p=await o.json();p&&r.push(...p)}return{files:r}}async function Nt(e,s,t,n){let a=(Array.isArray(e)?e:[e]).map(r=>r.blob);const i=a.filter(r=>r.size>(n??1/0));if(i.length)throw new Error(`File size exceeds the maximum allowed size of ${n} bytes: ${i.map(r=>r.name).join(", ")}`);return await Promise.all(await this.upload_files(s,a,t).then(async r=>{if(r.error)throw new Error(r.error);return r.files?r.files.map((o,u)=>new ve({...e[u],path:o,url:`${s}${this.api_prefix}/file=${o}`})):[]}))}class ve{constructor({path:s,url:t,orig_name:n,size:a,blob:i,is_stream:r,mime_type:o,alt_text:u,b64:c}){h(this,"path"),h(this,"url"),h(this,"orig_name"),h(this,"size"),h(this,"blob"),h(this,"is_stream"),h(this,"mime_type"),h(this,"alt_text"),h(this,"b64"),h(this,"meta",{_type:"gradio.FileData"}),this.path=s,this.url=t,this.orig_name=n,this.size=a,this.blob=t?void 0:i,this.is_stream=r,this.mime_type=o,this.alt_text=u,this.b64=c}}class St{constructor(s,t){h(this,"type"),h(this,"command"),h(this,"meta"),h(this,"fileData"),this.type="command",this.command=s,this.meta=t}}typeof process<"u"&&process.versions&&process.versions.node;function Ce(e,s,t){for(;t.length>1;){const a=t.shift();if(typeof a=="string"||typeof a=="number")e=e[a];else throw new Error("Invalid key type")}const n=t.shift();if(typeof n=="string"||typeof n=="number")e[n]=s;else throw new Error("Invalid key type")}async function ge(e,s=void 0,t=[],n=!1,a=void 0){if(Array.isArray(e)){let i=[];return await Promise.all(e.map(async(r,o)=>{var u;let c=t.slice();c.push(String(o));const m=await ge(e[o],n?((u=a?.parameters[o])==null?void 0:u.component)||void 0:s,c,!1,a);i=i.concat(m)})),i}else{if(globalThis.Buffer&&e instanceof globalThis.Buffer||e instanceof Blob)return[{path:t,blob:new Blob([e]),type:s}];if(typeof e=="object"&&e!==null){let i=[];for(const r of Object.keys(e)){const o=[...t,r],u=e[r];i=i.concat(await ge(u,void 0,o,!1,a))}return i}}return[]}function Pt(e,s){var t,n;let a=(n=(t=s?.dependencies)==null?void 0:t.find(i=>i.id==e))==null?void 0:n.queue;return a!=null?!a:!s.enable_queue}function Ct(e,s){return new Promise((t,n)=>{const a=new MessageChannel;a.port1.onmessage=({data:i})=>{a.port1.close(),t(i)},window.parent.postMessage(e,s,[a.port2])})}function le(e,s,t,n,a=!1){if(n==="input"&&!a)throw new Error("Invalid code path. Cannot skip state inputs for input.");if(n==="output"&&a)return e;let i=[],r=0;const o=n==="input"?s.inputs:s.outputs;for(let u=0;u<o.length;u++){const c=o[u],m=t.find(p=>p.id===c);if(m?.type==="state"){if(a)if(e.length===o.length){const p=e[r];i.push(p),r++}else i.push(null);else{r++;continue}continue}else{const p=e[r];i.push(p),r++}}return i}async function Tt(e,s,t){const n=this;await Ot(n,s);const a=await ge(s,void 0,[],!0,t);return(await Promise.all(a.map(async({path:i,blob:r,type:o})=>{if(!r)return{path:i,type:o};const u=await n.upload_files(e,[r]),c=u.files&&u.files[0];return{path:i,file_url:c,type:o,name:typeof File<"u"&&r instanceof File?r?.name:void 0}}))).forEach(({path:i,file_url:r,type:o,name:u})=>{if(o==="Gallery")Ce(s,r,i);else if(r){const c=new ve({path:r,orig_name:u});Ce(s,c,i)}}),s}async function Ot(e,s){var t,n;if(!((t=e.config)!=null&&t.root||(n=e.config)!=null&&n.root_url))throw new Error(Ue);await Fe(e,s)}async function Fe(e,s,t=[]){for(const n in s)s[n]instanceof St?await At(e,s,n):typeof s[n]=="object"&&s[n]!==null&&await Fe(e,s[n],[...t,n])}async function At(e,s,t){var n,a;let i=s[t];const r=((n=e.config)==null?void 0:n.root)||((a=e.config)==null?void 0:a.root_url);if(!r)throw new Error(Ue);try{let o,u;if(typeof process<"u"&&process.versions&&process.versions.node){const g=await ke(()=>import("./__vite-browser-external-DYxpcVy9-BIHI7g3E.js"),[]);u=(await ke(async()=>{const{resolve:b}=await import("./__vite-browser-external-DYxpcVy9-BIHI7g3E.js");return{resolve:b}},[])).resolve(process.cwd(),i.meta.path),o=await g.readFile(u)}else throw new Error(gt);const c=new Blob([o],{type:"application/octet-stream"}),m=await e.upload_files(r,[c]),p=m.files&&m.files[0];if(p){const g=new ve({path:p,orig_name:i.meta.name||""});s[t]=g}}catch(o){console.error(mt,o)}}async function It(e,s,t){const n={"Content-Type":"application/json"};this.options.token&&(n.Authorization=`Bearer ${this.options.token}`);try{var a=await this.fetch(e,{method:"POST",body:JSON.stringify(s),headers:{...n,...t},credentials:"include"})}catch{return[{error:ae},500]}let i,r;try{i=await a.json(),r=a.status}catch(o){i={error:`Could not parse server response: ${o}`},r=500}return[i,r]}async function Dt(e,s={}){let t=!1,n=!1;if(!this.config)throw new Error("Could not resolve app config");if(typeof e=="number")this.config.dependencies.find(a=>a.id==e);else{const a=e.replace(/^\//,"");this.config.dependencies.find(i=>i.id==this.api_map[a])}return new Promise(async(a,i)=>{const r=this.submit(e,s,null,null,!0);let o;for await(const u of r)u.type==="data"&&(n&&a(o),t=!0,o=u),u.type==="status"&&(u.stage==="error"&&i(u),u.stage==="complete"&&(n=!0,t&&a(o)))})}async function ne(e,s,t){let n=s==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${e}`:`https://huggingface.co/api/spaces/${e}`,a,i;try{if(a=await fetch(n),i=a.status,i!==200)throw new Error;a=await a.json()}catch{t({status:"error",load_status:"error",message:dt,detail:"NOT_FOUND"});return}if(!a||i!==200)return;const{runtime:{stage:r},id:o}=a;switch(r){case"STOPPED":case"SLEEPING":t({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:r}),setTimeout(()=>{ne(e,s,t)},1e3);break;case"PAUSED":t({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:r,discussions_enabled:await Te(o)});break;case"RUNNING":case"RUNNING_BUILDING":t({status:"running",load_status:"complete",message:"Space is running.",detail:r});break;case"BUILDING":t({status:"building",load_status:"pending",message:"Space is building...",detail:r}),setTimeout(()=>{ne(e,s,t)},1e3);break;case"APP_STARTING":t({status:"starting",load_status:"pending",message:"Space is starting...",detail:r}),setTimeout(()=>{ne(e,s,t)},1e3);break;default:t({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:r,discussions_enabled:await Te(o)});break}}const Ge=async(e,s)=>{let t=0;const n=12,a=5e3;return new Promise(i=>{ne(e,we.test(e)?"space_name":"subdomain",r=>{s(r),r.status==="running"||r.status==="error"||r.status==="paused"||r.status==="space_error"?i():(r.status==="sleeping"||r.status==="building")&&(t<n?(t++,setTimeout(()=>{Ge(e,s).then(i)},a)):i())})})},qt=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function Te(e){try{const s=await fetch(`https://huggingface.co/api/spaces/${e}/discussions`,{method:"HEAD"}),t=s.headers.get("x-error-message");return!(!s.ok||t&&qt.test(t))}catch{return!1}}async function zt(e,s){const t={};s&&(t.Authorization=`Bearer ${s}`);try{const n=await fetch(`https://huggingface.co/api/spaces/${e}/${nt}`,{headers:t});if(n.status!==200)throw new Error("Space hardware could not be obtained.");const{hardware:a}=await n.json();return a.current}catch(n){throw new Error(n.message)}}async function Rt(e,s,t){const n={};t&&(n.Authorization=`Bearer ${t}`);const a={seconds:s};try{const i=await fetch(`https://huggingface.co/api/spaces/${e}/${at}`,{method:"POST",headers:{"Content-Type":"application/json",...n},body:JSON.stringify(a)});if(i.status!==200)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await i.json()}catch(i){throw new Error(i.message)}}const Oe=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function Ut(e,s){const{token:t,private:n,hardware:a,timeout:i,auth:r}=s;if(a&&!Oe.includes(a))throw new Error(`Invalid hardware type provided. Valid types are: ${Oe.map(_=>`"${_}"`).join(",")}.`);const{http_protocol:o,host:u}=await ye(e,t);let c=null;if(r){const _=await Le(o,u,r,fetch);_&&(c=Be(_))}const m={Authorization:`Bearer ${t}`,"Content-Type":"application/json",...c?{Cookie:c.join("; ")}:{}},p=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:m})).json()).name,g=e.split("/")[1],b={repository:`${p}/${g}`};n&&(b.private=!0);let L;try{a||(L=await zt(e,t))}catch(_){throw Error(_e+_.message)}const l=a||L||"cpu-basic";b.hardware=l;try{const _=await fetch(`https://huggingface.co/api/spaces/${e}/duplicate`,{method:"POST",headers:m,body:JSON.stringify(b)});if(_.status===409)try{return await me.connect(`${p}/${g}`,s)}catch(v){throw console.error("Failed to connect Client instance:",v),v}else if(_.status!==200)throw new Error(_.statusText);const j=await _.json();return await Rt(`${p}/${g}`,i||300,t),await me.connect(Lt(j.url),s)}catch(_){throw new Error(_)}}function Lt(e){const s=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,t=e.match(s);if(t)return t[1]}var W;class Bt extends TransformStream{constructor(s={allowCR:!1}){super({transform:(t,n)=>{for(t=se(this,W)+t;;){const a=t.indexOf(`
`),i=s.allowCR?t.indexOf("\r"):-1;if(i!==-1&&i!==t.length-1&&(a===-1||a-1>i)){n.enqueue(t.slice(0,i)),t=t.slice(i+1);continue}if(a===-1)break;const r=t[a-1]==="\r"?a-1:a;n.enqueue(t.slice(0,r)),t=t.slice(a+1)}Xe(this,W,t)},flush:t=>{if(se(this,W)==="")return;const n=s.allowCR&&se(this,W).endsWith("\r")?se(this,W).slice(0,-1):se(this,W);t.enqueue(n)}}),Qe(this,W,"")}}W=new WeakMap;function Ft(e){let s=new TextDecoderStream,t=new Bt({allowCR:!0});return e.pipeThrough(s).pipeThrough(t)}function Gt(e){let s=/[:]\s*/.exec(e),t=s&&s.index;if(t)return[e.substring(0,t),e.substring(t+s[0].length)]}function Ae(e,s,t){e.get(s)||e.set(s,t)}async function*Mt(e,s){if(!e.body)return;let t=Ft(e.body),n,a=t.getReader(),i;for(;;){if(s&&s.aborted)return a.cancel();if(n=await a.read(),n.done)return;if(!n.value){i&&(yield i),i=void 0;continue}let[r,o]=Gt(n.value)||[];r&&(r==="data"?(i||(i={}),i[r]=i[r]?i[r]+`
`+o:o):r==="event"?(i||(i={}),i[r]=o):r==="id"?(i||(i={}),i[r]=+o||o):r==="retry"&&(i||(i={}),i[r]=+o||void 0))}}async function Jt(e,s){let t=new Request(e,s);Ae(t.headers,"Accept","text/event-stream"),Ae(t.headers,"Content-Type","application/json");let n=await fetch(t);if(!n.ok)throw n;return Mt(n,t.signal)}async function Wt(){let{event_callbacks:e,unclosed_events:s,pending_stream_messages:t,stream_status:n,config:a,jwt:i}=this;const r=this;if(!a)throw new Error("Could not resolve app config");n.open=!0;let o=null,u=new URLSearchParams({session_hash:this.session_hash}).toString(),c=new URL(`${a.root}${this.api_prefix}/${qe}?${u}`);if(i&&c.searchParams.set("__sign",i),o=this.stream(c),!o){console.warn("Cannot connect to SSE endpoint: "+c.toString());return}o.onmessage=async function(m){let p=JSON.parse(m.data);if(p.msg==="close_stream"){be(n,r.abort_controller);return}const g=p.event_id;if(!g)await Promise.all(Object.keys(e).map(b=>e[b](p)));else if(e[g]&&a){p.msg==="process_completed"&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(a.protocol)&&s.delete(g);let b=e[g];typeof window<"u"&&typeof document<"u"?setTimeout(b,0,p):b(p)}else t[g]||(t[g]=[]),t[g].push(p)},o.onerror=async function(m){console.error(m),await Promise.all(Object.keys(e).map(p=>e[p]({msg:"broken_connection",message:ae})))}}function be(e,s){e&&(e.open=!1,s?.abort())}function Ht(e,s,t){e[s]?t.data.forEach((n,a)=>{let i=Vt(e[s][a],n);e[s][a]=i,t.data[a]=i}):(e[s]=[],t.data.forEach((n,a)=>{e[s][a]=n}))}function Vt(e,s){return s.forEach(([t,n,a])=>{e=Zt(e,n,t,a)}),e}function Zt(e,s,t,n){if(s.length===0){if(t==="replace")return n;if(t==="append")return e+n;throw new Error(`Unsupported action: ${t}`)}let a=e;for(let r=0;r<s.length-1;r++)a=a[s[r]];const i=s[s.length-1];switch(t){case"replace":a[i]=n;break;case"append":a[i]+=n;break;case"add":Array.isArray(a)?a.splice(Number(i),0,n):a[i]=n;break;case"delete":Array.isArray(a)?a.splice(Number(i),1):delete a[i];break;default:throw new Error(`Unknown action: ${t}`)}return e}function Kt(e,s={}){const t={close:()=>{console.warn("Method not implemented.")},onerror:null,onmessage:null,onopen:null,readyState:0,url:e.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return Jt(e,s).then(async n=>{t.readyState=t.OPEN;try{for await(const a of n)t.onmessage&&t.onmessage(a);t.readyState=t.CLOSED}catch(a){t.onerror&&t.onerror(a),t.readyState=t.CLOSED}}).catch(n=>{console.error(n),t.onerror&&t.onerror(n),t.readyState=t.CLOSED}),t}function Qt(e,s={},t,n,a){var i;try{let r=function(y){(a||ie[y.type])&&m(y)},o=function(){for(We=!0;ee.length>0;)ee.shift()({value:void 0,done:!0})},u=function(y){ee.length>0?ee.shift()(y):ue.push(y)},c=function(y){u(Xt(y)),o()},m=function(y){u({value:y,done:!1})},p=function(){return ue.length>0?Promise.resolve(ue.shift()):new Promise(y=>ee.push(y))};const{token:g}=this.options,{fetch:b,app_reference:L,config:l,session_hash:_,api_info:j,api_map:v,stream_status:G,pending_stream_messages:re,pending_diff_streams:Z,event_callbacks:M,unclosed_events:ce,post_data:X,options:V,api_prefix:$}=this,N=this;if(!j)throw new Error("No API found");if(!l)throw new Error("Could not resolve app config");let{fn_index:f,endpoint_info:B,dependency:K}=Yt(j,e,v,l),de=kt(s,B),A,F=l.protocol??"ws";if(F==="ws")throw new Error("WebSocket protocol is not supported in this version");let S="",P=()=>S;const w=typeof e=="number"?"/predict":e;let J,k=null,R=!1,Y={},Q=typeof window<"u"&&typeof document<"u"?new URLSearchParams(window.location.search).toString():"";const ie=((i=V?.events)==null?void 0:i.reduce((y,I)=>(y[I]=!0,y),{}))||{};async function Me(){let y={},I={};y={event_id:k},I={event_id:k,session_hash:_,fn_index:f};try{if(!l)throw new Error("Could not resolve app config");"event_id"in I&&await b(`${l.root}${$}/${lt}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(I)}),await b(`${l.root}${$}/${ot}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(y)})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}const Je=async y=>{await this._resolve_heartbeat(y)};async function xe(y){if(!l)return;let I=y.render_id;l.components=[...l.components.filter(C=>C.props.rendered_in!==I),...y.components],l.dependencies=[...l.dependencies.filter(C=>C.rendered_in!==I),...y.dependencies];const pe=l.components.some(C=>C.type==="state"),E=l.dependencies.some(C=>C.targets.some(D=>D[1]==="unload"));l.connect_heartbeat=pe||E,await Je(l),r({type:"render",data:y,endpoint:w,fn_index:f})}this.handle_blob(l.root,de,B).then(async y=>{var I;if(J={data:le(y,K,l.components,"input",!0)||[],event_data:t,fn_index:f,trigger_id:n},Pt(f,l))r({type:"status",endpoint:w,stage:"pending",queue:!1,fn_index:f,time:new Date}),X(`${l.root}${$}/run${w.startsWith("/")?w:`/${w}`}${Q?"?"+Q:""}`,{...J,session_hash:_}).then(([E,C])=>{const D=E.data;C==200?(r({type:"data",endpoint:w,fn_index:f,data:le(D,K,l.components,"output",V.with_null_state),time:new Date,event_data:t,trigger_id:n}),E.render_config&&xe(E.render_config),r({type:"status",endpoint:w,fn_index:f,stage:"complete",eta:E.average_duration,queue:!1,time:new Date})):r({type:"status",stage:"error",endpoint:w,fn_index:f,message:E.error,queue:!1,time:new Date})}).catch(E=>{r({type:"status",stage:"error",message:E.message,endpoint:w,fn_index:f,queue:!1,time:new Date})});else if(F=="sse"){r({type:"status",stage:"pending",queue:!0,endpoint:w,fn_index:f,time:new Date});var pe=new URLSearchParams({fn_index:f.toString(),session_hash:_}).toString();let E=new URL(`${l.root}${$}/${qe}?${Q?Q+"&":""}${pe}`);if(this.jwt&&E.searchParams.set("__sign",this.jwt),A=this.stream(E),!A)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+E.toString()));A.onmessage=async function(C){const D=JSON.parse(C.data),{type:U,status:T,data:q}=Pe(D,Y[f]);if(U==="update"&&T&&!R)r({type:"status",endpoint:w,fn_index:f,time:new Date,...T}),T.stage==="error"&&(A?.close(),o());else if(U==="data"){let[O,x]=await X(`${l.root}${$}/queue/data`,{...J,session_hash:_,event_id:k});x!==200&&(r({type:"status",stage:"error",message:ae,queue:!0,endpoint:w,fn_index:f,time:new Date}),A?.close(),o())}else U==="complete"?R=T:U==="log"?r({type:"log",title:q.title,log:q.log,level:q.level,endpoint:w,duration:q.duration,visible:q.visible,fn_index:f}):(U==="generating"||U==="streaming")&&r({type:"status",time:new Date,...T,stage:T?.stage,queue:!0,endpoint:w,fn_index:f});q&&(r({type:"data",time:new Date,data:le(q.data,K,l.components,"output",V.with_null_state),endpoint:w,fn_index:f,event_data:t,trigger_id:n}),R&&(r({type:"status",time:new Date,...R,stage:T?.stage,queue:!0,endpoint:w,fn_index:f}),A?.close(),o()))}}else if(F=="sse_v1"||F=="sse_v2"||F=="sse_v2.1"||F=="sse_v3"){r({type:"status",stage:"pending",queue:!0,endpoint:w,fn_index:f,time:new Date});let E="";typeof window<"u"&&typeof document<"u"&&(E=(I=window?.location)==null?void 0:I.hostname);const C=E.includes(".dev.")?`https://moon-${E.split(".")[1]}.dev.spaces.huggingface.tech`:"https://huggingface.co";(typeof window<"u"&&typeof document<"u"&&window.parent!=window&&window.supports_zerogpu_headers?Ct("zerogpu-headers",C):Promise.resolve(null)).then(D=>X(`${l.root}${$}/${et}?${Q}`,{...J,session_hash:_},D)).then(async([D,U])=>{if(U===503)r({type:"status",stage:"error",message:ze,queue:!0,endpoint:w,fn_index:f,time:new Date});else if(U===422)r({type:"status",stage:"error",message:D.detail,queue:!0,endpoint:w,fn_index:f,code:"validation_error",time:new Date}),o();else if(U!==200)r({type:"status",stage:"error",broken:!1,message:D.detail,queue:!0,endpoint:w,fn_index:f,time:new Date});else{k=D.event_id,S=k;let T=async function(q){try{const{type:O,status:x,data:z,original_msg:He}=Pe(q,Y[f]);if(O=="heartbeat")return;if(O==="update"&&x&&!R)r({type:"status",endpoint:w,fn_index:f,time:new Date,original_msg:He,...x});else if(O==="complete")R=x;else if(O=="unexpected_error"||O=="broken_connection"){console.error("Unexpected error",x?.message);const Ve=O==="broken_connection";r({type:"status",stage:"error",message:x?.message||"An Unexpected Error Occurred!",queue:!0,endpoint:w,broken:Ve,session_not_found:x?.session_not_found,fn_index:f,time:new Date})}else if(O==="log"){r({type:"log",title:z.title,log:z.log,level:z.level,endpoint:w,duration:z.duration,visible:z.visible,fn_index:f});return}else(O==="generating"||O==="streaming")&&(r({type:"status",time:new Date,...x,stage:x?.stage,queue:!0,endpoint:w,fn_index:f}),z&&K.connection!=="stream"&&["sse_v2","sse_v2.1","sse_v3"].includes(F)&&Ht(Z,k,z));z&&(r({type:"data",time:new Date,data:le(z.data,K,l.components,"output",V.with_null_state),endpoint:w,fn_index:f}),z.render_config&&await xe(z.render_config),R&&(r({type:"status",time:new Date,...R,stage:x?.stage,queue:!0,endpoint:w,fn_index:f}),o())),(x?.stage==="complete"||x?.stage==="error")&&(M[k]&&delete M[k],k in Z&&delete Z[k])}catch(O){console.error("Unexpected client exception",O),r({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:w,fn_index:f,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(F)&&(be(G,N.abort_controller),G.open=!1,o())}};k in re&&(re[k].forEach(q=>T(q)),delete re[k]),M[k]=T,ce.add(k),G.open||await this.open_stream()}})}});let We=!1;const ue=[],ee=[],je={[Symbol.asyncIterator]:()=>je,next:p,throw:async y=>(c(y),p()),return:async()=>(o(),p()),cancel:Me,event_id:P};return je}catch(r){throw console.error("Submit function encountered an error:",r),r}}function Xt(e){return{then:(s,t)=>t(e)}}function Yt(e,s,t,n){let a,i,r;if(typeof s=="number")a=s,i=e.unnamed_endpoints[a],r=n.dependencies.find(o=>o.id==s);else{const o=s.replace(/^\//,"");a=t[o],i=e.named_endpoints[s.trim()],r=n.dependencies.find(u=>u.id==t[o])}if(typeof a!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:a,endpoint_info:i,dependency:r}}class me{constructor(s,t={events:["data"]}){h(this,"app_reference"),h(this,"options"),h(this,"deep_link",null),h(this,"config"),h(this,"api_prefix",""),h(this,"api_info"),h(this,"api_map",{}),h(this,"session_hash",Math.random().toString(36).substring(2)),h(this,"jwt",!1),h(this,"last_status",{}),h(this,"cookies",null),h(this,"stream_status",{open:!1}),h(this,"closed",!1),h(this,"pending_stream_messages",{}),h(this,"pending_diff_streams",{}),h(this,"event_callbacks",{}),h(this,"unclosed_events",new Set),h(this,"heartbeat_event",null),h(this,"abort_controller",null),h(this,"stream_instance",null),h(this,"current_payload"),h(this,"view_api"),h(this,"upload_files"),h(this,"upload"),h(this,"handle_blob"),h(this,"post_data"),h(this,"submit"),h(this,"predict"),h(this,"open_stream"),h(this,"resolve_config"),h(this,"resolve_cookies");var n;this.app_reference=s,this.deep_link=((n=t.query_params)==null?void 0:n.deep_link)||null,t.events||(t.events=["data"]),this.options=t,this.current_payload={},this.view_api=Et.bind(this),this.upload_files=$t.bind(this),this.handle_blob=Tt.bind(this),this.post_data=It.bind(this),this.submit=Qt.bind(this),this.predict=Dt.bind(this),this.open_stream=Wt.bind(this),this.resolve_config=wt.bind(this),this.resolve_cookies=yt.bind(this),this.upload=Nt.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}get_url_config(s=null){if(!this.config)throw new Error(H);s===null&&(s=window.location.href);const t=r=>r.replace(/^\/+|\/+$/g,"");let n=t(new URL(this.config.root).pathname),a=t(new URL(s).pathname),i;return a.startsWith(n)?i=t(a.substring(n.length)):i="",this.get_page_config(i)}get_page_config(s){if(!this.config)throw new Error(H);let t=this.config;return s in t.page||(s=""),{...t,current_page:s,layout:t.page[s].layout,components:t.components.filter(n=>t.page[s].components.includes(n.id)),dependencies:this.config.dependencies.filter(n=>t.page[s].dependencies.includes(n.id))}}fetch(s,t){const n=new Headers(t?.headers||{});if(this&&this.cookies&&n.append("Cookie",this.cookies),this&&this.options.headers)for(const a in this.options.headers)n.append(a,this.options.headers[a]);return fetch(s,{...t,headers:n})}stream(s){const t=new Headers;if(this&&this.cookies&&t.append("Cookie",this.cookies),this&&this.options.headers)for(const n in this.options.headers)t.append(n,this.options.headers[n]);return this&&this.options.token&&t.append("Authorization",`Bearer ${this.options.token}`),this.abort_controller=new AbortController,this.stream_instance=Kt(s.toString(),{credentials:"include",headers:t,signal:this.abort_controller.signal}),this.stream_instance}async init(){var s;this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then(({config:t})=>this._resolve_heartbeat(t)),this.api_info=await this.view_api(),this.api_map=_t(((s=this.config)==null?void 0:s.dependencies)||[])}async _resolve_heartbeat(s){if(s&&(this.config=s,this.api_prefix=s.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.token&&(this.jwt=await Ne(this.config.space_id,this.options.token,this.cookies))),s.space_id&&this.options.token&&(this.jwt=await Ne(s.space_id,this.options.token)),this.config&&this.config.connect_heartbeat){const t=new URL(`${this.config.root}${this.api_prefix}/${rt}/${this.session_hash}`);this.jwt&&t.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(t))}}static async connect(s,t={events:["data"]}){const n=new this(s,t);return t.session_hash&&(n.session_hash=t.session_hash),await n.init(),n}async reconnect(){const s=new URL(`${this.config.root}${this.api_prefix}/${ct}`);let t;try{const n=await this.fetch(s);if(!n.ok)throw new Error;t=(await n.json()).app_id}catch{return"broken"}return t!==this.config.app_id?"changed":"connected"}close(){this.closed=!0,be(this.stream_status,this.abort_controller)}set_current_payload(s){this.current_payload=s}static async duplicate(s,t={events:["data"]}){return Ut(s,t)}async _resolve_config(){const{http_protocol:s,host:t,space_id:n}=await ye(this.app_reference,this.options.token),{status_callback:a}=this.options;n&&a&&await Ge(n,a);let i;try{let r=`${s}//${t}`;if(i=await this.resolve_config(r),!i)throw new Error(H);return this.config_success(i)}catch(r){if(n&&a)ne(n,we.test(n)?"space_name":"subdomain",this.handle_space_success);else throw a&&a({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(r)}}async config_success(s){if(this.config=s,this.api_prefix=s.api_prefix||"",this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(t){console.error(ut+t.message)}return this.prepare_return_obj()}async handle_space_success(s){var t;if(!this)throw new Error(H);const{status_callback:n}=this.options;if(n&&n(s),s.status==="running")try{if(this.config=await this._resolve_config(),this.api_prefix=((t=this==null?void 0:this.config)==null?void 0:t.api_prefix)||"",!this.config)throw new Error(H);return await this.config_success(this.config)}catch(a){throw n&&n({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),a}}async component_server(s,t,n){var a;if(!this.config)throw new Error(H);const i={},{token:r}=this.options,{session_hash:o}=this;r&&(i.Authorization=`Bearer ${this.options.token}`);let u,c=this.config.components.find(p=>p.id===s);(a=c?.props)!=null&&a.root_url?u=c.props.root_url:u=this.config.root;let m;if("binary"in n){m=new FormData;for(const p in n.data)p!=="binary"&&m.append(p,n.data[p]);m.set("component_id",s.toString()),m.set("fn_name",t),m.set("session_hash",o)}else m=JSON.stringify({data:n,component_id:s,fn_name:t,session_hash:o}),i["Content-Type"]="application/json";r&&(i.Authorization=`Bearer ${r}`);try{const p=await this.fetch(`${u}${this.api_prefix}/${it}/`,{method:"POST",body:m,headers:i,credentials:"include"});if(!p.ok)throw new Error("Could not connect to component server: "+p.statusText);return await p.json()}catch(p){console.warn(p)}}set_cookies(s){this.cookies=Be(s).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}}function ss({story:e,data:s,setData:t,errors:n,imageFile:a,setImageFile:i,imagePreview:r,setImagePreview:o,onNext:u,t:c}){const[m,p]=te.useState(!1),[g,b]=te.useState(null),[L,l]=te.useState(null),[_,j]=te.useState(null),[v,G]=te.useState(0),Z=e?s.language==="arabic"?e.cover_image_ar:e.cover_image_en:null,M=Z?`/storage/${Z}`:null,ce=$=>{const N=$.target.files[0];if(N){if(!["image/jpeg","image/png"].includes(N.type)){j(c("invalid_image_format")||"Invalid format. Only JPG and PNG allowed.");return}const f=new Image;f.onload=()=>{if(f.naturalWidth<400||f.naturalHeight<400){j(c("image_too_small")||"Image too small. Minimum 400x400 pixels.");return}if(f.naturalWidth>6e3||f.naturalHeight>6e3){j(c("image_too_large")||"Image too large. Maximum 6000x6000 pixels.");return}i(N),t("child_image",N);const B=new FileReader;B.onloadend=()=>{o(B.result)},B.readAsDataURL(N),b(null),j(null)},f.src=URL.createObjectURL(N)}},X=async()=>{if(!a){l(c("please_upload_child_image")||"Please upload child image first");return}if(!M){l(c("no_cover_image"));return}p(!0),l(null),G(0);try{const $=[{progress:5,duration:3e3},{progress:10,duration:3e3},{progress:20,duration:1e4},{progress:35,duration:15e3},{progress:50,duration:2e4},{progress:65,duration:2e4},{progress:80,duration:2e4},{progress:95,duration:15e3}];let N=0,f;const B=()=>{if(N>=$.length){clearInterval(f);return}const P=$[N],w=N===0?0:$[N-1].progress,J=P.progress,k=Math.ceil(P.duration/200),R=(J-w)/k;let Y=0;f=setInterval(()=>{Y++,G(Q=>{const ie=Math.min(w+R*Y,J);return ie>=J&&(clearInterval(f),N++,N<$.length&&setTimeout(B,100)),Math.round(ie)})},200)};B();const de=await(await fetch(M)).blob(),A=a instanceof Blob?a:await fetch(r).then(P=>P.blob()),S=await(await me.connect("yusiff/face-swap")).predict("/predict",{source_img:A,target_img:de});if(f&&clearInterval(f),G(100),console.log("Full result:",S),S&&S.data){let P;Array.isArray(S.data)?P=S.data[0]?.url||S.data[0]:typeof S.data=="object"?P=S.data.url||S.data:P=S.data,console.log("Extracted image URL:",P),b(P),t("face_swap_result",P)}else throw new Error("No result from face swap API")}catch($){console.error("Face swap error:",$),l(c("face_swap_failed"))}finally{p(!1),setTimeout(()=>G(0),1e3)}},V=()=>{if(!g){l(c("please_generate_preview"));return}u()};return d.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20",children:[d.jsx("h2",{className:"text-2xl font-semibold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-6 py-4",children:c("customize_story_cover")}),d.jsx("div",{className:"flex justify-center items-center mb-6",children:d.jsx("div",{className:"w-96",children:d.jsx("img",{className:"object-contain w-full h-full",src:"/assets/createOrder/conditions.png",alt:""})})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:[c("child_image")," *"]}),d.jsx("div",{className:"border-2 border-dashed border-neutral-300 rounded-lg p-6 text-center",children:r?d.jsxs("div",{className:"space-y-4",children:[d.jsx("img",{src:r,alt:"Child preview",className:"max-w-full h-48 object-cover rounded-lg mx-auto"}),d.jsx("button",{type:"button",onClick:()=>{o(null),i(null),b(null),j(null)},className:"text-red-600 hover:text-red-800 text-sm",children:c("remove")})]}):d.jsxs("div",{children:[d.jsx("div",{className:"text-neutral-500 mb-4",children:d.jsx("i",{className:"fa-solid fa-cloud-arrow-up text-4xl"})}),d.jsx("p",{className:"text-neutral-600 mb-2",children:c("upload_child_image")}),d.jsx("input",{type:"file",accept:"image/jpeg,image/png",onChange:ce,className:"hidden",id:"child_image_step_zero"}),d.jsxs("label",{htmlFor:"child_image_step_zero",className:"inline-flex items-center px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 cursor-pointer transition-colors",children:[d.jsx("i",{className:"fa-solid fa-plus mx-2"}),c("choose_file")]})]})}),d.jsx(Ee,{message:n.child_image,className:"mt-2"}),d.jsx(Ee,{message:_,className:"mt-2"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:c("story_cover")}),d.jsx("div",{className:"border-2 border-neutral-300 rounded-lg p-4",children:M?d.jsx("img",{src:M,alt:e?.title_value||"Story cover",className:"max-w-full h-64 object-cover rounded-lg mx-auto"}):d.jsx("div",{className:"h-64 flex items-center justify-center text-neutral-400",children:d.jsxs("div",{className:"text-center",children:[d.jsx("i",{className:"fa-solid fa-image text-6xl mb-2"}),d.jsx("p",{children:c("no_cover_available")})]})})})]})]}),d.jsxs("div",{className:"mb-8 text-center",children:[d.jsx("button",{type:"button",onClick:X,disabled:m||!a,className:"px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold rounded-2xl hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:m?d.jsxs("span",{className:"flex items-center gap-3",children:[d.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),c("processing")]}):d.jsxs("span",{className:"flex items-center gap-3",children:[d.jsx("i",{className:"fa-solid fa-wand-magic-sparkles"}),c("generate_preview")]})}),m&&d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-4 overflow-hidden",children:d.jsxs("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-300 ease-out flex items-center justify-center text-white text-xs font-bold",style:{width:`${v}%`},children:[v,"%"]})}),d.jsxs("p",{className:"text-sm text-neutral-600 mt-2",children:[v<15&&c("uploading_images"),v>=15&&v<25&&c("analyzing_images"),v>=25&&v<48&&c("detecting_faces"),v>=48&&v<68&&c("processing_swap"),v>=68&&v<85&&c("blending_result"),v>=85&&v<95&&c("finalizing"),v>=95&&c("almost_done")]})]}),L&&d.jsx("div",{className:"mt-4 text-red-600 font-medium",children:L})]}),g&&d.jsxs("div",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-neutral-900 mb-4 flex items-center",children:[d.jsx("i",{className:"fa-solid fa-sparkles text-yellow-500 mx-2"}),c("preview_result")]}),d.jsx("div",{className:"border-4 border-green-200 rounded-2xl p-6 bg-gradient-to-br from-green-50 to-blue-50",children:d.jsx("img",{src:g,alt:"Face swap result",className:"max-w-full h-auto rounded-lg mx-auto shadow-xl"})}),d.jsxs("div",{className:"mt-4 text-center",children:[d.jsx("p",{className:"text-neutral-600 mb-4",children:c("satisfied_with_result")}),d.jsx("div",{className:"flex justify-center gap-4",children:d.jsxs("button",{type:"button",onClick:()=>{b(null),l(null)},className:"px-6 py-2 border-2 border-orange-500 text-orange-600 font-semibold rounded-lg hover:bg-orange-50 transition-colors",children:[d.jsx("i",{className:"fa-solid fa-rotate-right mx-2"}),c("try_again")]})})]})]}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{type:"button",onClick:V,disabled:!g,className:"px-10 py-4 bg-gradient-to-r from-orange-500 via-pink-500 to-purple-600 text-white font-bold rounded-2xl hover:from-orange-600 hover:via-pink-600 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:d.jsxs("span",{className:"flex items-center gap-3 rtl:flex-row-reverse",children:[c("confirm_and_continue"),d.jsx("i",{className:"fa-solid fa-arrow-right rtl:fa-arrow-left"})]})})})]})}export{ss as default};
