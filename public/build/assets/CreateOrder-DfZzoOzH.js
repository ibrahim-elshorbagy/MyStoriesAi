import{r as m,a as F,j as r,H as O}from"./app-Dz9zRKTf.js";import{S as I}from"./SiteLayout-BaIEJJVL.js";import{u as C}from"./useTrans-BkTq1qdy.js";import D from"./StepZero-Rwcbgr1L.js";import V from"./StepOne-Cad00EWF.js";import Z from"./StepThree-Bd4bbYbS.js";import"./Toastify-D5LnU_t9.js";import"./Header-Bi9J0nk4.js";import"./ApplicationLogo-9RMnaNcN.js";import"./PrimaryButton-EZaemYzg.js";import"./CookieModal-DuGeE3aF.js";import"./AppModal-CoIrN-Ov.js";import"./SecondaryButton-DAOdr1B7.js";import"./InputError-CpNqAWcN.js";import"./TextInput-P0SxYzJp.js";import"./TextArea-vRsCMuWp.js";import"./SelectInput-5r0v4jbl.js";import"./InputLabel-BxIgClOt.js";function re({pricing:S,deliveryOptions:$,story:a=null}){const{t}=C(),[o,s]=m.useState(a?0:1),[l,_]=m.useState(null),[g,x]=m.useState(null),[w,p]=m.useState({}),[f,y]=m.useState(!!a),{data:i,setData:b,post:k,processing:E,errors:d}=F({story_id:a?.id||null,face_swap_result:null,child_name:"",child_age:"",language:a?"arabic":"",child_gender:"",format:"",value:[],custom_value:"",hair_color:"",hair_style:"",eye_color:"",skin_tone:"",clothing_description:"",customer_note:"",child_image:null,story_price:0});m.useEffect(()=>{if(Object.keys(d).length>0){const e=["story_id","face_swap_result","child_image"],n=["child_name","child_age","language","child_gender","format","value","custom_value","hair_color","hair_style","eye_color","skin_tone","clothing_description","customer_note","story_price"],u=Object.keys(d).some(c=>e.includes(c)),T=Object.keys(d).some(c=>n.includes(c));u&&a?s(0):T&&s(1),setTimeout(()=>{const c=document.querySelector(".text-red-600");c&&c.scrollIntoView({behavior:"smooth",block:"center"})},200)}},[d]);const h={...d,...w},v=()=>{const e={};return!i.child_name||i.child_name.trim()===""?e.child_name=t("required")||"The child name field is required.":i.child_name.length>255&&(e.child_name=t("validation_max_string")),(!i.child_age||i.child_age==="")&&(e.child_age=t("required")),i.language||(e.language=t("required")),i.child_gender||(e.child_gender=t("required")),i.format||(e.format=t("required")),!f&&(!i.value||i.value.length===0)&&(e.value=t("required")),!l&&!f?e.child_image=t("required"):l&&(["image/jpeg","image/png","image/jpg","image/gif","image/webp"].includes(l.type)||(e.child_image=t("validation_mimes")),l.size>5120*1024&&(e.child_image=t("validation_max_file"))),p(e),Object.keys(e).length===0},j=e=>{if(e===1&&o===0){p({}),y(!0),s(e);return}if(e===3&&!v()){s(1),setTimeout(()=>{const n=document.querySelector(".text-red-600");n&&n.scrollIntoView({behavior:"smooth",block:"center"})},100);return}p({}),s(e)},N=e=>{if(e.preventDefault(),!v()){s(1),setTimeout(()=>{const u=document.querySelector(".text-red-600");u&&u.scrollIntoView({behavior:"smooth",block:"center"})},100);return}const n={...i};n.child_image=l,k(route("frontend.order.store"),n,{forceFormData:!0,preserveScroll:!0,onError:u=>{},onSuccess:()=>{}})},q=()=>{if(o===0)return t("customize_story")||"تخصيص القصة";if(o===1)return t("step_1")||"الخطوة 1";if(o===3)return t("step_3")||"الخطوة 3"};return r.jsxs(I,{children:[r.jsx(O,{title:t("create_story_title")||"إنشاء قصة"}),r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 py-16",children:r.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[r.jsxs("div",{className:"text-center mb-12",children:[r.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-orange-400 to-pink-500 rounded-full mb-6 shadow-lg",children:r.jsx("i",{className:"fa-solid fa-book-open text-3xl text-white"})}),r.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-4 py-4",children:t("create_story_title")||"إنشاء قصة مخصصة"}),r.jsx("p",{className:"text-xl text-neutral-600 font-medium",children:q()}),r.jsx("div",{className:"mt-6 flex justify-center",children:r.jsxs("div",{className:"flex items-center space-x-4 rtl:space-x-reverse",children:[a&&r.jsx("div",{className:`${o===0?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":o>0?"w-2 h-2 bg-green-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`}),r.jsx("div",{className:`${o===1?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":o>1?"w-2 h-2 bg-green-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`}),r.jsx("div",{className:`${o===3?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`})]})})]}),r.jsxs("form",{onSubmit:N,children:[o===0&&a&&r.jsx(D,{story:a,data:i,setData:b,errors:h,imageFile:l,setImageFile:_,imagePreview:g,setImagePreview:x,onNext:()=>j(1),t}),o===1&&r.jsx(V,{data:i,setData:b,errors:h,pricing:S,imagePreview:g,setImagePreview:x,imageFile:l,setImageFile:_,onNext:()=>j(3),onBack:f?()=>s(0):null,cameFromStepZero:f,t}),o===3&&r.jsx(Z,{data:i,imagePreview:g,onBack:()=>s(1),onEdit:e=>s(e),processing:E,errors:h,t})]})]})})]})}export{re as default};
