import{u as k,r as o,j as e,H as V,c as $}from"./app-dQO12pfE.js";import{S as B}from"./SiteLayout-ykha-d-5.js";import{u as I}from"./useTrans-BkTq1qdy.js";import K from"./ShippingForm-BLkzP1rZ.js";import"./Toastify-Dfipb58T.js";import"./Header-CZZSC9uB.js";import"./ApplicationLogo-C8wINeIM.js";import"./PrimaryButton-BIFP49uI.js";import"./CookieModal-2iVMNMp9.js";import"./AppModal-5iGWADln.js";import"./SecondaryButton-CTnJNuNG.js";function se({cart:x,order:r,deliveryOptions:g=[]}){const{t:s}=I(),{errors:D,csrf_token:S}=k().props,[F,C]=o.useState("stripe"),[j,P]=o.useState(()=>r?.shipping_address?{delivery_option_id:r.shipping_address.delivery_option_id||"",area:r.shipping_address.area||"",street:r.shipping_address.street||"",house_number:r.shipping_address.house_number||"",additional_info:r.shipping_address.additional_info||""}:{delivery_option_id:"",area:"",street:"",house_number:"",additional_info:""}),[n,b]=o.useState(""),[i,d]=o.useState(null),[v,l]=o.useState(""),[m,N]=o.useState(!1),c=x?x.cart_items:r?.order_items,p=!!x,A=!0,E={first_plan:s("format_first_plan")||"Digital PDF",second_plan:s("format_second_plan")||"Softcover Book",third_plan:s("format_third_plan")||"Hardcover Book"},_=c?.length||0,u=parseFloat(p?c?.reduce((t,a)=>t+parseFloat(a.story_price||0),0)??0:r?.subtotal??c?.reduce((t,a)=>t+parseFloat(a.story_price||0),0)??0),T=g.find(t=>t.id==j.delivery_option_id),h=parseFloat(p?T?.price??0:r?.delivery_total??0),f=i?Math.round(u*i.percent/100*100)/100:0,q=u+h-f,L=p?route("frontend.order.processPayment"):route("frontend.order.processPayment.old",r.id),y={honesty:s("learning_value_honesty"),kindness:s("learning_value_kindness"),courage:s("learning_value_courage"),respect:s("learning_value_respect"),responsibility:s("learning_value_responsibility"),friendship:s("learning_value_friendship"),perseverance:s("learning_value_perseverance"),creativity:s("learning_value_creativity")},M=async t=>{if(t.preventDefault(),!n.trim()){l(s("discount_code_required"));return}N(!0),l("");try{console.log("Attempting to validate discount code:",n);const a=await $.post(route("cart.validateDiscount"),{code:n},{headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":S}});console.log("Discount validation response:",a.data),a.data.success?(d(a.data.discount),l(""),console.log("Discount applied successfully:",a.data.discount)):(l(a.data.message||s("discount_not_found")),d(null),console.log("Discount validation failed:",a.data.message))}catch(a){console.error("Discount validation error:",a),a.response?(console.error("Server error response:",a.response.data),l(a.response.data.message||s("discount_validation_error"))):a.request?(console.error("No response received:",a.request),l(s("discount_validation_error"))):(console.error("Request setup error:",a.message),l(s("discount_validation_error"))),d(null)}finally{N(!1)}},R=()=>{d(null),b(""),l("")};return e.jsxs(B,{children:[e.jsx(V,{title:s("checkout")}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-orange-400 to-pink-500 rounded-full mb-6 shadow-lg",children:e.jsx("i",{className:"fa-solid fa-credit-card text-3xl text-white"})}),e.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-4 py-4",children:s("checkout")}),e.jsx("p",{className:"text-xl text-neutral-600 font-medium",children:s("review_and_complete_payment")}),e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"flex items-center space-x-4 rtl:space-x-reverse",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500 rounded-full"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/40",children:[e.jsxs("h2",{className:"text-2xl font-bold text-neutral-900 mb-6 flex items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-box-open text-orange-500"}),s("your_order")," (",_," ",s(_===1?"item":"items"),")"]}),e.jsx("div",{className:"space-y-6",children:c?.map((t,a)=>e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-100 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:t.child_image_path?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`/storage/${t.child_image_path}`,alt:t.child_name,className:"w-24 h-24 rounded-2xl object-cover border-4 border-orange-400 shadow-lg"}),e.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 bg-gradient-to-br from-orange-400 to-pink-500 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-md",children:a+1})]}):e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-orange-400 to-pink-500 rounded-2xl flex items-center justify-center text-white font-bold text-2xl shadow-lg",children:a+1})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-neutral-900 mb-1",children:t.child_name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-neutral-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-cake-candles text-orange-500"}),t.child_age," ",s("years")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:`fa-solid ${t.child_gender==="boy"?"fa-mars text-blue-500":"fa-venus text-pink-500"}`}),s(t.child_gender)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa-solid fa-language text-purple-500"}),s(t.language)]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[t.story_price," ",s("currency")]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-blue-100 px-3 py-2 rounded-lg",children:[e.jsx("i",{className:"fa-solid fa-book text-blue-600"}),e.jsx("span",{className:"text-sm font-semibold text-neutral-800",children:E[t.format]})]}),t.story&&e.jsxs("div",{className:"flex items-center gap-2 bg-purple-100 px-3 py-2 rounded-lg",children:[e.jsx("i",{className:"fa-solid fa-bookmark text-purple-600"}),e.jsx("span",{className:"text-sm font-semibold text-neutral-800 truncate",children:t.story.title_value})]})]}),t.value&&t.value.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-xl border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("i",{className:"fa-solid fa-heart text-green-600"}),e.jsxs("h4",{className:"font-semibold text-neutral-900 text-sm",children:[s("learning_values"),":"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.value.map((w,H)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full border border-green-300",children:[e.jsx("i",{className:"fa-solid fa-check-circle"}),y[w]?`${y[w]}`:""]},H))})]}),t.custom_value&&e.jsx("div",{className:"bg-yellow-50 p-3 rounded-lg border-2 border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fa-solid fa-lightbulb text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"text-xs font-semibold text-neutral-600",children:[s("learning_value"),":"]}),e.jsx("p",{className:"text-sm text-neutral-800 font-medium",children:t.custom_value})]})]})}),(t.hair_color||t.hair_style||t.eye_color||t.skin_tone)&&e.jsxs("div",{className:"grid grid-cols-2  gap-2",children:[t.hair_color&&e.jsxs("div",{className:"bg-white p-2 rounded-lg border-2 border-neutral-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-neutral-500 font-semibold",children:s("hair_color")}),e.jsx("div",{className:"text-sm font-bold text-neutral-800 truncate",children:t.hair_color})]}),t.hair_style&&e.jsxs("div",{className:"bg-white p-2 rounded-lg border-2 border-neutral-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-neutral-500 font-semibold",children:s("hair_style")}),e.jsx("div",{className:"text-sm font-bold text-neutral-800 truncate",children:t.hair_style})]}),t.eye_color&&e.jsxs("div",{className:"bg-white p-2 rounded-lg border-2 border-neutral-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-neutral-500 font-semibold",children:s("eye_color")}),e.jsx("div",{className:"text-sm font-bold text-neutral-800 truncate",children:t.eye_color})]}),t.skin_tone&&e.jsxs("div",{className:"bg-white p-2 rounded-lg border-2 border-neutral-200 shadow-sm",children:[e.jsx("div",{className:"text-xs text-neutral-500 font-semibold",children:s("skin_tone")}),e.jsx("div",{className:"text-sm font-bold text-neutral-800 truncate",children:t.skin_tone})]})]}),t.clothing_description&&e.jsx("div",{className:"bg-indigo-50 p-3 rounded-lg border-2 border-indigo-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fa-solid fa-shirt text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"text-xs font-semibold text-neutral-600",children:[s("clothing_description"),":"]}),e.jsx("p",{className:"text-sm text-neutral-800",children:t.clothing_description})]})]})}),t.customer_note&&e.jsx("div",{className:"bg-pink-50 p-3 rounded-lg border-2 border-pink-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:"fa-solid fa-comment-dots text-pink-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"text-xs font-semibold text-neutral-600",children:[s("customer_note"),":"]}),e.jsx("p",{className:"text-sm text-neutral-800",children:t.customer_note})]})]})})]})]})},t.id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("form",{method:"post",action:L,className:"sticky top-6",noValidate:!0,children:[e.jsx("input",{type:"hidden",name:"_token",value:k().props.csrf_token}),e.jsx("input",{type:"hidden",name:"discount_code",value:i?n:""}),e.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/40 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-receipt text-orange-500"}),s("order_summary")]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-neutral-700",children:[e.jsxs("span",{children:[s("subtotal"),":"]}),e.jsxs("span",{className:"font-semibold",children:[u.toFixed(2)," ",s("currency")]})]}),h>0&&e.jsxs("div",{className:"flex justify-between text-neutral-700",children:[e.jsxs("span",{children:[s("delivery_total"),":"]}),e.jsxs("span",{className:"font-semibold",children:[h.toFixed(2)," ",s("currency")]})]}),i&&f>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-tag"}),s("discount")," (",i.percent,"%)"]}),e.jsxs("span",{className:"font-semibold",children:["-",f.toFixed(2)," ",s("currency")]})]}),e.jsxs("div",{className:"border-t-2 border-orange-200 pt-3 flex justify-between items-center",children:[e.jsxs("span",{className:"text-lg font-bold text-neutral-900",children:[s("total_price"),":"]}),e.jsxs("span",{className:"text-2xl font-bold text-orange-600",children:[q.toFixed(2)," ",s("currency")]})]})]})]}),e.jsxs("div",{className:"border-t-2 border-neutral-200 pt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-tag text-orange-500"}),s("discount_code")]}),i?e.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fa-solid fa-check text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-neutral-900",children:n}),e.jsxs("p",{className:"text-sm text-green-700",children:[i.percent,"% ",s("discount_applied")]})]})]}),e.jsx("button",{type:"button",onClick:R,className:"text-red-600 hover:text-red-700 hover:bg-red-100 p-2 rounded-lg transition-all duration-200",title:s("remove_discount"),children:e.jsx("i",{className:"fa-solid fa-times text-xl"})})]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:n,onChange:t=>b(t.target.value.toUpperCase()),placeholder:s("enter_discount_code"),className:"flex-1 px-4 py-3 border-2 border-neutral-300 rounded-xl focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-all duration-200",disabled:m}),e.jsx("button",{type:"button",onClick:M,disabled:m||!n.trim(),className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-pink-500 text-white font-semibold rounded-xl hover:from-orange-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:m?e.jsx("i",{className:"fa-solid fa-spinner fa-spin"}):s("apply")})]}),v&&e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-exclamation-circle"}),v]})})]})]}),e.jsx(K,{shippingData:j,setShippingData:P,deliveryOptions:g,needsShipping:A,errors:D}),e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:s("payment_method")}),e.jsx("div",{className:"border-2 border-orange-500 bg-orange-50 rounded-xl p-4 shadow-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{type:"radio",name:"payment_method",value:"stripe",checked:F==="stripe",onChange:()=>C("stripe"),className:"mt-1 ltr:mr-3 rtl:ml-3 w-5 h-5 text-orange-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("i",{className:"fa-solid fa-credit-card text-xl text-blue-600"}),e.jsx("h4",{className:"font-bold text-neutral-900",children:s("payment_stripe")})]}),e.jsx("p",{className:"text-sm text-neutral-600",children:s("payment_stripe_desc")})]})]})})]}),e.jsx("button",{type:"submit",className:"w-full my-4 px-8 py-4 bg-gradient-to-r from-orange-500 via-pink-500 to-purple-600 text-white font-bold text-lg rounded-2xl hover:from-orange-600 hover:via-pink-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:e.jsxs("span",{className:"flex rtl:flex-row-reverse items-center justify-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-lock"}),e.jsx("span",{children:s("complete_payment")}),e.jsx("i",{className:"fa-solid fa-arrow-right"})]})}),e.jsxs("div",{className:"text-center text-xs text-neutral-500 flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-shield-halved text-green-600"}),e.jsx("span",{children:s("secure_payment")})]})]})})]})]})})]})}export{se as default};
