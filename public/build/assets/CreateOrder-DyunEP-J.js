import{r as u,a as C,j as i,H as D}from"./app-CmjdSMvU.js";import{S as $}from"./SiteLayout-xYSkc0Xt.js";import{u as B}from"./useTrans-BkTq1qdy.js";import Z from"./StepZero-BjRw1_1U.js";import z from"./StepOne-D0gRxJyl.js";import H from"./StepTwo-1AF5It2I.js";import P from"./StepThree-03HCT1ha.js";import"./Toastify-Cqr0u1IV.js";import"./Header-CvGdXmPU.js";import"./ApplicationLogo-XwI7EIx0.js";import"./PrimaryButton-DmmwwnBh.js";import"./CookieModal-DPznALOx.js";import"./AppModal-CrBGLZT4.js";import"./SecondaryButton-CKGMLTKC.js";import"./InputError-MwXv_bOv.js";import"./TextInput-BzzhkyHX.js";import"./TextArea-BKXniEHM.js";import"./SelectInput-D_PXNFfA.js";import"./InputLabel-DyeBRmEs.js";function ae({pricing:w,deliveryOptions:k,story:a=null}){const{t}=B(),[o,n]=u.useState(a?0:1),[d,v]=u.useState(null),[g,j]=u.useState(null),[y,f]=u.useState({}),[h,E]=u.useState(!!a),{data:r,setData:p,post:q,processing:N,errors:m}=C({story_id:a?.id||null,face_swap_result:null,child_name:"",child_age:"",language:a?"arabic":"",child_gender:"",format:"",value:[],custom_value:"",hair_color:"",hair_style:"",eye_color:"",skin_tone:"",clothing_description:"",customer_note:"",child_image:null,story_price:0,delivery_price:0,total_price:0,delivery_option_id:"",area:"",street:"",house_number:"",additional_info:""});u.useEffect(()=>{if(Object.keys(m).length>0){const e=["story_id","face_swap_result","child_image"],s=["child_name","child_age","language","child_gender","format","value","custom_value","hair_color","hair_style","eye_color","skin_tone","clothing_description","customer_note","story_price"],l=["delivery_option_id","area","street","house_number","additional_info","delivery_price"],F=Object.keys(m).some(c=>e.includes(c)),I=Object.keys(m).some(c=>s.includes(c)),V=Object.keys(m).some(c=>l.includes(c));F&&a?n(0):I?n(1):V&&n(2),setTimeout(()=>{const c=document.querySelector(".text-red-600");c&&c.scrollIntoView({behavior:"smooth",block:"center"})},200)}},[m]);const _={...m,...y},x=()=>{const e={};return!r.child_name||r.child_name.trim()===""?e.child_name=t("required")||"The child name field is required.":r.child_name.length>255&&(e.child_name=t("validation_max_string")),(!r.child_age||r.child_age==="")&&(e.child_age=t("required")),r.language||(e.language=t("required")),r.child_gender||(e.child_gender=t("required")),r.format||(e.format=t("required")),(!r.value||r.value.length===0)&&(e.value=t("required")),!d&&!h?e.child_image=t("required"):d&&(["image/jpeg","image/png","image/jpg","image/gif","image/webp"].includes(d.type)||(e.child_image=t("validation_mimes")),d.size>5120*1024&&(e.child_image=t("validation_max_file"))),f(e),Object.keys(e).length===0},S=()=>{if(r.format==="first_plan")return f({}),!0;const e={};return(!r.delivery_option_id||r.delivery_option_id==="custom")&&(e.delivery_option_id=t("required")),!r.area||r.area.trim()===""?e.area=t("required"):r.area.length>255&&(e.area=t("validation_max_string")),!r.street||r.street.trim()===""?e.street=t("required"):r.street.length>255&&(e.street=t("validation_max_string")),!r.house_number||r.house_number.trim()===""?e.house_number=t("required"):r.house_number.length>255&&(e.house_number=t("validation_max_string")),f(e),Object.keys(e).length===0},b=e=>{if(e===1&&o===0){f({}),E(!0),n(e);return}if(e===2&&!x()){setTimeout(()=>{const s=document.querySelector(".text-red-600");s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100);return}if(e===3){if(!x()){n(1),setTimeout(()=>{const s=document.querySelector(".text-red-600");s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100);return}if(!S()){n(2),setTimeout(()=>{const s=document.querySelector(".text-red-600");s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100);return}}f({}),n(e)},T=e=>{if(e.preventDefault(),!x()||!S()){Object.keys(y).some(l=>["child_name","child_age","language","child_gender","format","value","child_image"].includes(l))?n(1):n(2),setTimeout(()=>{const l=document.querySelector(".text-red-600");l&&l.scrollIntoView({behavior:"smooth",block:"center"})},100);return}const s={...r};s.child_image=d,q(route("frontend.order.store"),s,{forceFormData:!0,preserveScroll:!0,onError:l=>{console.log("Validation errors:",l)},onSuccess:()=>{console.log("Order submitted successfully")}})},O=()=>{if(o===0)return t("customize_story")||"تخصيص القصة";if(o===1)return t("step_1")||"الخطوة 1";if(o===2)return r.format==="first_plan"?t("step_3")||"الخطوة 3":t("step_2")||"الخطوة 2";if(o===3)return t("step_3")||"الخطوة 3"};return i.jsxs($,{children:[i.jsx(D,{title:t("create_story_title")||"إنشاء قصة"}),i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 py-16",children:i.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[i.jsxs("div",{className:"text-center mb-12",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-orange-400 to-pink-500 rounded-full mb-6 shadow-lg",children:i.jsx("i",{className:"fa-solid fa-book-open text-3xl text-white"})}),i.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-4 py-4",children:t("create_story_title")||"إنشاء قصة مخصصة"}),i.jsx("p",{className:"text-xl text-neutral-600 font-medium",children:O()}),i.jsx("div",{className:"mt-6 flex justify-center",children:i.jsxs("div",{className:"flex items-center space-x-4 rtl:space-x-reverse",children:[a&&i.jsx("div",{className:`${o===0?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":o>0?"w-2 h-2 bg-green-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`}),i.jsx("div",{className:`${o===1?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":o>1?"w-2 h-2 bg-green-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`}),i.jsx("div",{className:`${o===2?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":o>2?"w-2 h-2 bg-green-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`}),i.jsx("div",{className:`${o===3?"w-12 h-2 bg-gradient-to-r from-orange-400 to-pink-500":"w-2 h-2 bg-neutral-300"} rounded-full transition-all duration-300`})]})})]}),i.jsxs("form",{onSubmit:T,children:[o===0&&a&&i.jsx(Z,{story:a,data:r,setData:p,errors:_,imageFile:d,setImageFile:v,imagePreview:g,setImagePreview:j,onNext:()=>b(1),t}),o===1&&i.jsx(z,{data:r,setData:p,errors:_,pricing:w,imagePreview:g,setImagePreview:j,imageFile:d,setImageFile:v,onNext:()=>b(r.format==="first_plan"?3:2),onBack:h?()=>n(0):null,cameFromStepZero:h,t}),o===2&&r.format!=="first_plan"&&i.jsx(H,{data:r,setData:p,errors:_,deliveryOptions:k,onNext:()=>b(3),onBack:()=>n(1),t}),o===3&&i.jsx(P,{data:r,imagePreview:g,onBack:()=>n(r.format==="first_plan"?1:2),onEdit:e=>n(e),processing:N,errors:_,t})]})]})})]})}export{ae as default};
